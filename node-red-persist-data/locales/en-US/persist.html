
<script type="text/html" data-help-name="persist-data">
    <p>Persists data across deployment and node-red restarts. Data can be full global or flow context,
        selected context keys, or the last payload received. By default data is assumed 
        to be JSON formatted unless 'raw' flag is enabled in which case data treated as a buffer. 
        The node only outputs restored data, not incoming messages, but an incoming 
        message can trigger an immediate data capture and save anytime by including the msg.save
        property. The save message will be treated as the last payload if msg.save has a truthy value;
        however, a falsy (but defined) value will inhibit saving that msg.payload.
    </p>
    <h3>Inputs</h3>
    <ul>
        <li><code>Name</code> defines the display name for the node.</li>
        <li><code>File</code> defines the filespec for the save/recall operations.</li>
        <li><code>Delay</code> defines the a delay in seconds before recalling data. Default 0.1s</li>
        <li><code>Capture</code> defines what data source is used with choises being:</li>
            <ul>
                <li><code>Global Context:</code> the full global context or selected keys.</li>
                <li><code>Flow Context:</code> the full flow context or selected keys.</li>
                <li><code>Last Payload</code> Last msg.payload received.</li>
            </ul>
        <li><code>Keys</code> defines the captured context keys to include when saving and restoring data.</li>
        <li><code>Raw</code> flag to treat data as raw content (i.e. buffer), otherwise converted to JSON format.</li>
    </ul>
    <h3>Outputs</h3>
    <p>No specific properties, although input settings may influence output messages and format.</p>
    <p>When restored, if capture mode is defined as Last msg.payload, restored data gets sent out as a 
        new msg.payload, otherwise, the respective flow or global context gets set and then passed as a 
        new msg.payload. If no restored data is found the node outputs a null payload.</p>
    <p>No input messages ever pass to output.</p>
    <h3>Messages</h3>
    <ul>
        <li><code>msg.save</code> when defined, forces the immediate saving of data. If truthy, the payload 
            of the "save" msg is treated as the last payload, but if falsy then the prior msg.payload as assumed.</li>
        <li><code>msg.payload</code> when capture mode is defined as Last msg.payload, incoming msg.payload 
            gets saved to memory until the node closes. Note: only the most recent payload is saved 
            overwriting any previous payload.</li>
    </ul>
        
</script>
